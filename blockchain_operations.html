<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="canonical" href="https://cattlechain.readthedocs.org/blockchain_operations.html">
  <link rel="shortcut icon" href="img/favicon.ico">
  <title>Blockchain Operations - Cattlechain 4.0</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="css/theme.css" />
  <link rel="stylesheet" href="css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" />
  <link href="https://www.fiware.org/style/fiware_readthedocs.css" rel="stylesheet" />
  <link href="https://www.fiware.org/style/fiware_readthedocs_core.css" rel="stylesheet" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "Blockchain Operations";
    var mkdocs_page_input_path = "blockchain_operations.md";
    var mkdocs_page_url = "/blockchain_operations.html";
  </script>
  
  <script src="js/jquery-2.1.1.min.js" defer></script>
  <script src="js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
  <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', '', '');
      ga('send', 'pageview');
  </script>
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href="." class="icon icon-home"> Cattlechain 4.0</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="./search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="index.html">Home</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="architecture.html">Architecture</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="datamodel.html">Data Models</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="usages.html">Usage</a>
                    </li>
                </ul>
                <ul class="current">
                    <li class="toctree-l1 current"><a class="reference internal current" href="blockchain_operations.html">Blockchain Operations</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#introduction">Introduction</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#use-of-aei-contract">Use of AEI Contract</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#erc-721">ERC 721</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#aei-contract-design">AEI Contract Design</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#example">Example</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#methods">Methods</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#dependencies">Dependencies</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#use-of-canis-major">Use of Canis Major</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#canis-major-design">Canis Major Design</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#usages">Usages</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#creation-of-an-entity-animal-farm-etc">Creation of an Entity (Animal, Farm etc)</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#adding-metadata-eventy-on-an-entity-animal-farm-etc">Adding Metadata (eventy) on an Entity (Animal, Farm etc)</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#qyery">Qyery</a>
    </li>
        </ul>
    </li>
    </ul>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="ml_operations.html">ML/AI Operations</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="environment.html">Environment</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="evaluation.html">Evaluation</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="future_work.html">Future Work</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href=".">Cattlechain 4.0</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".">Docs</a> &raquo;</li>
    
      
    
    <li>Blockchain Operations</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/cattlechain/docs/edit/master/doc/blockchain_operations.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="blockchain-operations">Blockchain Operations</h1>
<h2 id="introduction">Introduction</h2>
<p>The blockchain interaction in CattleChain project is really staright forward, earlier the development was happening using Hyperledger Sawtooth, as sawtooth lack in various aspect and we decided to use the stable/proven blockchain technology.</p>
<p>To do so we are currenlty using Alastria Network, a non-profit association that promotes the digital economy through the development of decentralised ledger technologies/Blockchain and also a member of FIWARE.</p>
<p>Alastria partners have two operational networks (Network T and Network B) on which nodes can be deployed (either regular nodes or critical: validators and bootnodes).</p>
<p>The first of Alastria’s partner node networks (Red T) is built on Quorum technology,an open-source Ethereum client developed under the LGPL license and written in Go. GoQuorum is an Ethereum-based protocol that runs private, permissioned networks.</p>
<p>To know more about it follow here:</p>
<p><a href="https://github.com/alastria/alastria-node">Alastria Network</a>
<a href="https://docs.goquorum.consensys.net/en/stable/">Quorum Technology</a></p>
<h2 id="use-of-aei-contract">Use of AEI Contract</h2>
<p>CattleChain project using AEI (Asset, Event, Identity) Standard Contract. AEI Smart Contract is written in Solidity using ERC721 standard (NFT) and can be use with Ethereum Clients. It is compatible with FIWARE-Canis Major Adaptor to store the data in blockchain. AEI, asset, events (metadata), identity, is designed to store the NGSI-LD model with the help of Canis Major Adaptor.</p>
<p>ERC 721 Contract is follow OpenZepplin standards, security audits are trusted by leading organizations building decentralized systems.</p>
<h3 id="erc-721">ERC 721</h3>
<p>ERC 721 A standard interface for non-fungible tokens, also known as deeds.
The following standard allows for the implementation of a standard API for NFTs within smart contracts. This standard provides basic functionality to track and transfer NFTs.</p>
<p>We considered use cases of NFTs being owned and transacted by individuals as well as consignment to third party brokers/wallets/auctioneers (“operators”). NFTs can represent ownership over digital or physical assets. We considered a diverse universe of assets, and we know you will dream up many more:</p>
<p>Physical property — houses, unique artwork
Virtual collectables — unique pictures of kittens, collectable cards
“Negative value” assets — loans, burdens and other responsibilities
In general, all houses are distinct and no two kittens are alike. NFTs are distinguishable and you must track the ownership of each one separately.</p>
<p>to know more follow here: </p>
<p><a href="https://eips.ethereum.org/EIPS/eip-721">ERC 721</a>
<a href="https://docs.openzeppelin.com/contracts/2.x/api/token/erc721">OpenZepplin ERC721</a></p>
<h3 id="aei-contract-design">AEI Contract Design</h3>
<p>AEI contract is cosist of 3 aspects (see the figure below):</p>
<ul>
<li>Entity/Asset with a unique identity will be a new asset (1:1 mapping of asset to an identity).</li>
<li>Event or Metadata of the asset/entity has a 1:n mapping.</li>
<li>An Asset can have a 1:n relationship with any other asset.</li>
</ul>
<p><img alt="AEI Contract Design" src="https://raw.githubusercontent.com/FIWARE-Blockchain/AEIContract/master/docs/images/1.png" /></p>
<h4 id="example">Example</h4>
<p><img alt="Example" src="https://raw.githubusercontent.com/FIWARE-Blockchain/AEIContract/master/docs/images/2.png" /></p>
<p>To Store the NGSI-LD model there are few possibilities with the help of some supported storage type:</p>
<ol>
<li>IPFS</li>
<li>IOTA MaM</li>
<li>MerkleRoot</li>
</ol>
<p><img alt="Example" src="https://raw.githubusercontent.com/FIWARE-Blockchain/AEIContract/master/docs/images/3.png" /></p>
<h3 id="methods">Methods</h3>
<pre><code class="language-sh">- createAsset(bytes32 uuid, string memory _newHash)
- getAsset(bytes32 uuid)
- updateAsset(bytes32 uuid, string memory _newHash)
- removeAsset (bytes32 uuid)
- isValidAsset(bytes32 uuid, bytes32[] memory _proof, bytes32 _leaf)
- isValidAssetEthMessage(bytes32 uuid, bytes32 _messageHash, bytes memory _signature)
- addRelation(bytes32 uuid, bytes32 reluuid)
- getRelations(bytes32 uuid)
- removeRelation(bytes32 uuid, uint index)
- isValidRelation(bytes32 uuid, uint index, bytes32[] memory _proof, bytes32 _leaf)
- addMetadata(bytes32 uuid, string memory _metadatahash)
- getMetadatas(bytes32 uuid) public view returns (string[] memory)
- removeMetadata(bytes32 uuid, uint index)
- isValidMetadata(bytes32 uuid, uint index, bytes32[] memory _proof, bytes32 _leaf)
</code></pre>
<p>Apart from that ERC721, Ownable, MerkleProof, ECDSA methods are supported.</p>
<h3 id="dependencies">Dependencies</h3>
<p><em>This project uses:</em>
 - truffle
 - NodeJS
 - Ganache-CLI (testrpc)
 - OpenZeppelin</p>
<p>to know more follow here: </p>
<p><a href="https://github.com/FIWARE-Blockchain/AEIContract">GitHub Source</a></p>
<h2 id="use-of-canis-major">Use of Canis Major</h2>
<p>CanisMajor is a blockchain adaptor that supports various DLT.</p>
<h3 id="canis-major-design">Canis Major Design</h3>
<p><img alt="CanisMajor Design" src="https://raw.githubusercontent.com/CattleChain/Docs/master/images/cm.png" /></p>
<p>The way Canis Major work's in 'Powered By FIWARE' architecture as follows:</p>
<ol>
<li>Request from the user is consist of the Payload, Header with token and DLT_ID (base64 of public key and private key of the blockchain).</li>
<li>Wilma PEP Proxy validate the token and check with the KeyRock IDM and validate the user, permission (Authentication and Autherisation).</li>
<li>Once the user is validate Wilma forward the request to the Context Broker and persist it.</li>
<li>Once the Payload stored in Context Broker Wilma notify to Canis Major with the configuration such as what attribute of the payload should be store, Blockchain Identity of the user.</li>
<li>Futher Canis Major persist the data in blockchain using AEI contract (will be explained futher in this chapter).</li>
</ol>
<p><a href="https://github.com/FIWARE-Blockchain/CanisMajor">Github Souce</a>
<a href="https://fiware-blockchain.github.io/CanisMajor/architecture.html">Documentation</a></p>
<h2 id="usages">Usages</h2>
<h3 id="creation-of-an-entity-animal-farm-etc">Creation of an Entity (Animal, Farm etc)</h3>
<p><img alt="Creation of an entity" src="https://raw.githubusercontent.com/CattleChain/Docs/master/images/createentity.png" /></p>
<h3 id="adding-metadata-eventy-on-an-entity-animal-farm-etc">Adding Metadata (eventy) on an Entity (Animal, Farm etc)</h3>
<p><img alt="Adding Metadata" src="https://raw.githubusercontent.com/CattleChain/Docs/master/images/addattr.png" /></p>
<h3 id="qyery">Qyery</h3>
<p><img alt="Query" src="https://raw.githubusercontent.com/CattleChain/Docs/master/images/query.png" /></p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="ml_operations.html" class="btn btn-neutral float-right" title="ML/AI Operations">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="usages.html" class="btn btn-neutral" title="Usage"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/cattlechain/docs/" class="fa fa-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="usages.html" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="ml_operations.html" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '.';</script>
    <script src="js/theme.js" defer></script>
      <script src="search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
